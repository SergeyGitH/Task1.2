```
Создание витрины 'sales' в `Clickhouse`:
```sql
WITH sales AS 
	(SELECT * FROM (
		SELECT * FROM shop_dns 
		union all 
		SELECT * FROM shop_mvideo 
		union all 
		SELECT * FROM shop_sitilink
		)
	)
	select
		toMonth(plan_date) AS month,
		shops.shop_name as shop_name,
		product.product_name,
		sum(sales_cnt) as sales_fact,
		sum(plan_cnt) as sales_plan,
		sum(sales_cnt)/sum(plan_cnt) AS seles_fact_plan,
		sum(sales_cnt) * price AS income_fact,
		sum(plan_cnt) * price AS income_plan,
		(sum(sales_cnt) * price) - (sum(plan_cnt) * price) AS income_fact_plan
	from sales
join shops on sales.shop_id = shops.shop_id
join plan on plan.shop_name = shops.shop_name
join product on product.product_id = sales.product_id
GROUP by month, shops.shop_name, product.product_name, product.price
```
